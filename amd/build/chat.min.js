define("mod_moodlechatbot/chat",["exports","core/ajax","core/notification","core/templates","core/log"],(function(_exports,_ajax,_notification,_templates,_log){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_templates=_interopRequireDefault(_templates),_log=_interopRequireDefault(_log);const Selectors_MESSAGES_CONTAINER='[data-region="messages"]',Selectors_INPUT='[data-region="input"]',Selectors_SEND_BUTTON='[data-action="send"]';_exports.init=chatId=>{const chatContainer=document.getElementById(chatId);if(!chatContainer)return void _log.default.debug("Chat container not found with id: ".concat(chatId));const messagesContainer=chatContainer.querySelector(Selectors_MESSAGES_CONTAINER),input=chatContainer.querySelector(Selectors_INPUT),sendButton=chatContainer.querySelector(Selectors_SEND_BUTTON),displayMessage=async messageData=>{try{const messageHtml=await _templates.default.renderForPromise("mod_moodlechatbot/chat_message",messageData);messagesContainer.insertAdjacentHTML("beforeend",messageHtml.html),messagesContainer.scrollTop=messagesContainer.scrollHeight}catch(error){_log.default.error("Error displaying message:",error),_notification.default.exception(error)}},sendMessage=()=>{const message=input.value.trim();if(!message)return;const chatbotId=chatContainer.dataset.chatbotid;displayMessage({sender:"You",content:message,isbot:!1}),input.value="",_ajax.default.call([{methodname:"mod_moodlechatbot_send_message",args:{chatbotid:chatbotId,message:message},done:async response=>{try{"success"===response.status?await displayMessage({sender:"Bot",content:response.message,isbot:!0}):_notification.default.alert("Error",response.message)}catch(error){_log.default.error("Error processing response:",error),_notification.default.exception(error)}},fail:error=>{_log.default.error("AJAX call failed:",error),_notification.default.exception(error)}}])};sendButton.addEventListener("click",sendMessage),input.addEventListener("keypress",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),sendMessage())})),_log.default.debug("Chat initialized successfully")}}));

//# sourceMappingURL=chat.min.js.map